<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  
  <title>gulp的使用方法 | LTH&#39;s note book</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
    <meta name="author" content="kyjo2014">
  
  
    <meta name="description" content="基本用法// gulpfile.jsgulp.task(‘foo’, function() {    gulp.src(glob)        .pipe(…)        .pipe(…)        .pipe(gulp.dest(…))        .pipe(…)        .pipe(gulp.dest(…))});
// shell$ gulp foo基本 APIgulp.">
  
  <meta name="description" content="基本用法// gulpfile.jsgulp.task(‘foo’, function() {    gulp.src(glob)        .pipe(…)        .pipe(…)        .pipe(gulp.dest(…))        .pipe(…)        .pipe(gulp.dest(…))});
// shell$ gulp foo基本 APIgulp.">
<meta property="og:type" content="article">
<meta property="og:title" content="gulp的使用方法">
<meta property="og:url" content="http://yoursite.com/2016/03/15/gulp的使用方法/index.html">
<meta property="og:site_name" content="LTH's note book">
<meta property="og:description" content="基本用法// gulpfile.jsgulp.task(‘foo’, function() {    gulp.src(glob)        .pipe(…)        .pipe(…)        .pipe(gulp.dest(…))        .pipe(…)        .pipe(gulp.dest(…))});
// shell$ gulp foo基本 APIgulp.">
<meta property="og:updated_time" content="2016-03-16T16:39:51.226Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="gulp的使用方法">
<meta name="twitter:description" content="基本用法// gulpfile.jsgulp.task(‘foo’, function() {    gulp.src(glob)        .pipe(…)        .pipe(…)        .pipe(gulp.dest(…))        .pipe(…)        .pipe(gulp.dest(…))});
// shell$ gulp foo基本 APIgulp.">
  
    <link rel="alternate" href="/atom.xml" title="LTH&#39;s note book" type="application/atom+xml">
  
  
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>

<body>
  <div class="wrapper">
    <header id="header">
  <div class="title">
    <h1><a href="/">LTH&#39;s note book</a></h1>
    <p><a href="/">逗逼+未来の程序员</a></p>
  </div>
  <nav class="nav">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
        <li><a href="/Reading">Reading</a></li>
      
        <li><a href="/about">About</a></li>
      
        <li><a href="/testing">TestArea</a></li>
      
      
        <li><a href="/atom.xml">RSS</a></li>
      
    </ul>
    <div class="clearfix"></div>
  </nav>
  <div class="clearfix"></div>
</header>
    <div class="content"><article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2016/03/15/gulp的使用方法/">
  <time datetime="2016-03-15T15:40:24.000Z">
    2016-03-15
  </time>
</a>
    
    
  
    <h1 class="title">gulp的使用方法</h1>
  

  </header>
  
  <div class="entry">
    
      <p>基本用法<br>// gulpfile.js<br>gulp.task(‘foo’, function() {<br>    gulp.src(glob)<br>        .pipe(…)<br>        .pipe(…)<br>        .pipe(gulp.dest(…))<br>        .pipe(…)<br>        .pipe(gulp.dest(…))<br>});</p>
<p>// shell<br>$ gulp foo<br>基本 API<br>gulp.src(glob[, options])<br>根据 glob 匹配文件，返回 stream，可以通过 .pipe() 方法传递给后续的插件。<br>gulp.dest(path[, options])<br>一般用法 .pipe(gulp.dest(path))，把 pipe 中的内容按照指定的 path 写成文件，会自动创建不存在的文件夹。<br>注意，可以通过 .pipe 多次指定输出的地方，具体请看 这里<br>gulp.task(name[, deps], fn)<br>定义名为 name 的任务，定义之后就可以在命令行中使用 gulp xxx 来执行任务。<br>deps 里面的任务全部完成后才会执行 fn<br>deps 里面的任务都是并行执行的，如果需要顺序执行，需要特殊写法。具体看 这里<br>gulp.watch(glob[, opts, cb])<br>监听文件变化<br>不会监听新文件（目录），所以一般你会需要 gulp-watch<br>常用命令 （自定义）</p>
<h1 id="for_development_mode">for development mode</h1><p>gulp server</p>
<h1 id="run_test">run test</h1><p>gulp test</p>
<h1 id="for_production_mode">for production mode</h1><p>gulp build<br>gulp server 流程<br>把 less, sass, 之类的文件编译成 CSS，常用插件：<br>gulp-less<br>gulp-sass<br>创建 Web Server (with Live Reload)，常用：<br>gulp-connect，用来创建 Web Server，其实还有其他选择的，但多数都是利用 connect 来创建 Web Server 的。<br>node-proxy-middle，用来代理请求，可以把 /api/xxx 发送到指定的地址。(常用于 SPA 开发)<br>connect-modrewrite，匹配资源，如果不匹配就可以重定向到指定地址。(常用于 SPA 开发)<br>connect-history-api-fallback，作用同上，也用于匹配资源，但用起来简单很多。(常用于 SPA 开发)<br>监听文件变化，常用插件：<br>gulp-watch<br>示例代码<br>    gulp.task(‘clean:css’, function () {<br>        del.sync(‘app/styles/*.css’);<br>    });</p>
<pre><code>gulp.task(<span class="string">'less'</span>, [<span class="string">'clean:css'</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{
    <span class="keyword">var</span> stream = gulp
            .src(<span class="string">'app/styles/main.less'</span>)
            .pipe(less())
            .pipe(gulp.dest(<span class="string">'app/styles/'</span>));
    <span class="keyword">return</span> stream;
});

gulp.task(<span class="string">'connect'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{
    connect.server({
        root: <span class="string">'./app'</span>,
        port: <span class="number">9000</span>,
        livereload: <span class="literal">true</span>,
        middleware: <span class="function"><span class="keyword">function</span> (<span class="params">connect, o</span>) </span>{
            <span class="keyword">return</span> [
                (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{
                    <span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">'url'</span>);
                    <span class="keyword">var</span> proxy = <span class="built_in">require</span>(<span class="string">'proxy-middleware'</span>);
                    <span class="keyword">var</span> options = url.parse(<span class="string">'http://localhost:3000/api'</span>);
                    options.route = <span class="string">'/api'</span>;
                    <span class="keyword">return</span> proxy(options);
                })(),
                modRewrite([
                    <span class="string">'!\\.html|\\.js|\\.css|\\.swf|\\.jp(e?)g|\\.png|\\.gif|\\.eot|\\.woff|\\.ttf|\\.svg$ /index.html'</span>
                ])
            ];
        }
    });
});

gulp.task(<span class="string">'watch'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{
    gulp
        .src(<span class="string">'app/styles/**/*.less'</span>, {read: <span class="literal">false</span>})
        .pipe(watch(<span class="string">'app/styles/**/*.less'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{
            <span class="keyword">return</span> gulp
                .src(<span class="string">'app/styles/main.less'</span>)
                .pipe(less())
                .pipe(gulp.dest(<span class="string">'app/styles/'</span>))
                .pipe(connect.reload());
        }));

gulp
    .src([<span class="string">'app/scripts/**/*.js'</span>, <span class="string">'app/**/*.html'</span>])
    .pipe(watch([<span class="string">'app/scripts/**/*.js'</span>, <span class="string">'app/**/*.html'</span>]))
    .pipe(plumber())
    .pipe(connect.reload());
});

gulp.task(<span class="string">'server'</span>, [<span class="string">'less'</span>, <span class="string">'connect'</span>, <span class="string">'watch'</span>]);
gulp build 流程
清理 dist/ 文件夹
del，根据 glob 来删除文件/目录
压缩文件
gulp-htmlmin，压缩 html 文件
gulp-minify-html，同上
gulp-cssmin，压缩 css 文件
gulp-minify-css，同上，封装了 clean-css，star 比上面的多
gulp-uglify，混淆 JavaScript 代码
gulp-usemin，合并指定 block 中的文件
gulp-rev，给静态文件加上版本号，如 app.js -&gt; app-d41d8cd98f.js
复制其他文件到 dist/
gulp.src(...).pipe(gulp.dest(...))
实例代码
gulp.task(<span class="string">'clean:build'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{
    del.sync(<span class="string">'dist/'</span>, {force: <span class="literal">true</span>});
});

gulp.task(<span class="string">'minify'</span>, [<span class="string">'clean:build'</span>, <span class="string">'less'</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{
    gulp
        .src(<span class="string">'app/views/**/*.html'</span>)
        .pipe(htmlmin({collapseWhitespace: <span class="literal">true</span>}))
        .pipe(gulp.dest(<span class="string">'dist/views'</span>));

    gulp
        .src(<span class="string">'app/index.html'</span>)
        .pipe(usemin({
            js: [uglify(), rev()],
            css: [minifyCss(), <span class="string">'concat'</span>, rev()]
        }))
        .pipe(gulp.dest(<span class="string">'dist/'</span>));
});

gulp.task(<span class="string">'copyfonts'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{
    gulp
        .src(<span class="string">'app/styles/fonts/*'</span>)
        .pipe(gulp.dest(<span class="string">'dist/fonts/'</span>));
});

gulp.task(<span class="string">'build'</span>, [<span class="string">'clean:build'</span>, <span class="string">'minify'</span>, <span class="string">'copyfonts'</span>]);
</code></pre><p>转载自 scarlex 的文章 利用gulp处理前端工作流程 </p>

    
  </div>
  <footer>
    
      
      
  <div class="tags">
    <a class="tags-link" href="/tags/gulp/">gulp</a>
  </div>

    
    <div class="clearfix"></div>
  </footer>
</article>

</div>
  </div>
  <footer id="footer"><div class="copyright">
  
  &copy; 2016 <a href="/">kyjo2014</a>
  
</div>
<div class="theme-copyright">
  Theme by <a href="https://github.com/orderedlist" target="_blank">orderedlist</a>
   | 
  Redesign by <a href="http://heroicyang.com/" target="_blank">Heroic Yang</a>
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script src="/js/scale.fix.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
  (function($){
    $('.fancybox').fancybox();
  })(jQuery);
</script>

</body>
</html>