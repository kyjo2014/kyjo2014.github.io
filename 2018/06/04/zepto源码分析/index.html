<!DOCTYPE html>
<html lang="zh">
    <head>
    <!-- 
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.3.0 -->

    <!-- Title -->
    
    <title>
        
            zepto源码分析 | 
        
        LTH&#39;s note book
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Meta & Info -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="kyjo2014">
    <meta name="description" content="html|css|javascript|LTH&#39;s blog">
    <meta name="keywords" content="123,Javascript | zepto">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="LTH&#39;s note book">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://kyjo2014.github.com">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="zepto源码分析 | LTH&#39;s note book">
    <meta property="og:description" content="html|css|javascript|LTH&#39;s blog">
    <meta property="og:article:tag" content="Javascript | zepto"> 

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS -->
    <link rel="stylesheet" href="/css/material.min.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <!-- Config CSS -->


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }
</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>



    <script src="/js/jquery.min.js"></script>
    <script src="/js/queue.js"></script>

    <!-- UC Browser Compatible -->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write("<link rel=\"stylesheet\" href=\"/css/uc.css\">");
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    

    

    <!-- Bing Background -->
    

    <!-- Custom Head -->
    
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#zepto-源码解析"><span class="post-toc-number">1.</span> <span class="post-toc-text">zepto 源码解析</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#序言"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">序言</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#zepto-js"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">zepto.js</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#fragment方法"><span class="post-toc-number">1.2.1.</span> <span class="post-toc-text">fragment方法</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Z方法"><span class="post-toc-number">1.2.2.</span> <span class="post-toc-text">Z方法</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#isZ方法"><span class="post-toc-number">1.2.3.</span> <span class="post-toc-text">isZ方法</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#init方法"><span class="post-toc-number">1.2.4.</span> <span class="post-toc-text">init方法</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#函数"><span class="post-toc-number">1.2.5.</span> <span class="post-toc-text">$函数</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#extend函数"><span class="post-toc-number">1.2.6.</span> <span class="post-toc-text">$.extend函数</span></a></li></ol></li></ol></li></ol>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script>
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').css('background-image', 'url(' + '/img/random/material-' + randomNum + '.png' + ')');
</script>

        
    
            <p class="article-headline-p">
                zepto源码分析
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/myavatar.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>kyjo2014</strong>
        <span>6月 04, 2018</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/Javascript-zepto/">Javascript | zepto</a>
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=zepto源码分析&url=http://kyjo2014.github.com//2018/06/04/zepto源码分析/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=zepto源码分析&url=http://kyjo2014.github.com//2018/06/04/zepto源码分析/index.html&via=kyjo2014" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://kyjo2014.github.com//2018/06/04/zepto源码分析/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://kyjo2014.github.com//2018/06/04/zepto源码分析/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h1 id="zepto-源码解析"><a href="#zepto-源码解析" class="headerlink" title="zepto 源码解析"></a>zepto 源码解析</h1><h2 id="序言"><a href="#序言" class="headerlink" title="序言"></a>序言</h2><p>​    zepto是一个小巧的DOM操作库，又被称为迷你版JQuery。其大小适中，API设计精细，使用方式与JQuery差不多，使之成为移动端常用的DOM操作库。特别在新版本中zepto也采用了模块拆分的方式，把许多功能拆分到不同文件，保证了核心代码文件的大小。</p>
<table>
<thead>
<tr>
<th>模块</th>
<th>默认</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/zepto.js#files" target="_blank" rel="external">zepto</a></td>
<td>✔</td>
<td>核心模块; 包含大多数方法</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/event.js#files" target="_blank" rel="external">event</a></td>
<td>✔</td>
<td>通过on()＆off()</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/ajax.js#files" target="_blank" rel="external">ajax</a></td>
<td>✔</td>
<td>XMLHttpRequest和JSONP功能</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/form.js#files" target="_blank" rel="external">form</a></td>
<td>✔</td>
<td>序列化并提交网页表单</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/ie.js#files" target="_blank" rel="external">ie</a></td>
<td>✔</td>
<td>支持桌面和Windows Phone 8上的Internet Explorer 10+</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/detect.js#files" target="_blank" rel="external">detect</a></td>
<td></td>
<td>提供<code>$.os</code>和<code>$.browser</code>信息</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/fx.js#files" target="_blank" rel="external">fx</a></td>
<td></td>
<td>提供<code>animate()</code>方法</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/fx_methods.js#files" target="_blank" rel="external">fx_methods</a></td>
<td></td>
<td>提供动画<code>show</code>，<code>hide</code>，<code>toggle</code>，和<code>fade*()</code>方法。</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/assets.js#files" target="_blank" rel="external">assets</a></td>
<td></td>
<td>从DOM中删除图像元素后清理iOS内存的实验性支持。</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/data.js#files" target="_blank" rel="external">data</a></td>
<td></td>
<td>一种全面的<code>data()</code>方法，能够在内存中存储任意对象。</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/deferred.js#files" target="_blank" rel="external">deferred</a></td>
<td></td>
<td>提供<code>$.Deferred</code>promise化API。取决于“回调”模块。</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/callbacks.js#files" target="_blank" rel="external">callbacks</a></td>
<td></td>
<td>提供<code>$.Callbacks</code>在“延迟”模块中使用。</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/selector.js#files" target="_blank" rel="external">selector</a></td>
<td></td>
<td>实验jQuery CSS扩展支持诸如<code>$(&#39;div:first&#39;)</code>和的 功能<code>el.is(&#39;:visible&#39;)</code>。</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/touch.js#files" target="_blank" rel="external">touch</a></td>
<td></td>
<td>在触控设备上触发点击和滑动相关的事件。这适用于“touch”（iOS，Android）和“指针”事件（Windows Phone）。</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/gesture.js#files" target="_blank" rel="external">gesture</a></td>
<td></td>
<td>触发在触摸设备上捏手势事件</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/stack.js#files" target="_blank" rel="external">stack</a></td>
<td></td>
<td>提供<code>andSelf</code>和<code>end()</code>链接方法</td>
</tr>
<tr>
<td><a href="https://github.com/madrobby/zepto/blob/master/src/ios3.js#files" target="_blank" rel="external">ios3</a></td>
<td></td>
<td>为了与iOS 3.x兼容，String.prototype.trim和Array.prototype.reduce方法（如果缺失）。</td>
</tr>
</tbody>
</table>
<p>下面对每个文件的代码进行抽丝剥茧，探讨每个文件的实现过程。</p>
<h2 id="zepto-js"><a href="#zepto-js" class="headerlink" title="zepto.js"></a>zepto.js</h2><p>​    zepto.js是DOM库的核心文件，其核心是一个立即调用函数。由于JavaScript是函数作用域，使用立即调用函数能够为zepto的代码隔离出一个私有作用域。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var Zepto = (</div><div class="line">function () </div><div class="line">&#123;...&#125;</div><div class="line">) () ;//立即调用函数</div><div class="line">// If `$` is not yet defined, point it to `Zepto`</div><div class="line">window.Zepto = Zepto ;</div><div class="line">((window.$) === undefined) &amp;&amp; (window.$ = Zepto) ;</div></pre></td></tr></table></figure>
<p>​    除此之外为了兼容所有浏览器，zepto把自身绑定到window对象下。直接使用对象名访问zepto要每次都输入zepto，非常不方便。所以zepto也会绑定到\$变量下。\$是一个众多框架都是喜爱使用的符号变量，不可避免在zepto加载前\$已经被使用了。直接覆盖变量值会导致页面出错，所以zepto也实现了类似<code>JQuery.noconflict()</code>类似的功能。先检测\$为undefined再赋值。</p>
<p>​    接下来分析立即调用函数的内部。zepto把许多常用的代码和API都保存在变量里。保存的内容主要分以下种类：</p>
<ol>
<li><p>保存浏览器常量，防止被覆盖</p>
<p>因为JavaScript语言在ES6之前是没有定义后就不能改的常量类型，任何变量值都可以被修改。所以，为了保证能够获取浏览器提供的默认值，需要在函数内部保存默认值的拷贝。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> <span class="literal">undefined</span>,</div><div class="line"><span class="comment">//变量声明时默认值是就是undefined</span></div><div class="line">propMap = &#123;<span class="string">"tabindex"</span>: <span class="string">"tabIndex"</span>,<span class="string">"readonly"</span>: <span class="string">"readOnly"</span>...&#125;,</div><div class="line"><span class="comment">//html标签的属性名全部是小写，在JavaScript中相对应的属性名为驼峰写法，建立一个</span></div><div class="line"><span class="comment">//属性映射能够加快api的查找</span></div></pre></td></tr></table></figure>
</li>
<li><p>用缩写名作为变量保存API，简化调用方式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">emptyArray = [],</div><div class="line">concat = emptyArray.concat,</div><div class="line">filter = emptyArray.filter,</div><div class="line">slice = emptyArray.slice,</div><div class="line"><span class="built_in">document</span> = <span class="built_in">window</span>.document,</div></pre></td></tr></table></figure>
<p>相比每次使用concat方法都要重写[].concat直接调用concat变量显得更加方便。</p>
</li>
<li><p>为正则表达式起个合适名字，方便了解代码逻辑</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">fragmentRE = <span class="regexp">/^\s*&lt;(\w+|!)[^&gt;]*&gt;/</span>,</div><div class="line"><span class="comment">//获取fragment的名称</span></div><div class="line">singleTagRE = <span class="regexp">/^&lt;(\w+)\s*\/?&gt;(?:&lt;\/\1&gt;|)$/</span>,</div><div class="line"><span class="comment">//匹配自闭合标签名称</span></div><div class="line">tagExpanderRE = <span class="regexp">/&lt;(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^&gt;]*)\/&gt;/ig</span>,</div><div class="line"> <span class="comment">//匹配特殊的自闭合标签</span></div><div class="line">rootNodeRE = <span class="regexp">/^(?:body|html)$/i</span>,</div><div class="line"> <span class="comment">//匹配根元素</span></div><div class="line">capitalRE = <span class="regexp">/([A-Z])/g</span>,</div><div class="line"><span class="comment">//匹配大写字母</span></div></pre></td></tr></table></figure>
</li>
<li><p>保存常用的工具方法，减少代码冗余</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">isArray = (<span class="built_in">Array</span>.isArray) || (<span class="function"><span class="keyword">function</span> (<span class="params">object</span>) </span>&#123;...&#125;) ;</div><div class="line"><span class="comment">//判断是否为变量是否为数组</span></div><div class="line">camelize = <span class="function"><span class="keyword">function</span> (<span class="params">str</span>)</span>&#123;...&#125; ;</div><div class="line"><span class="comment">//把形如a-b-c的字符串转换为aBc</span></div><div class="line">uniq = <span class="function"><span class="keyword">function</span> (<span class="params">array</span>)</span>&#123;...&#125; ;</div><div class="line"><span class="comment">//删除数组中重复的值</span></div></pre></td></tr></table></figure>
<p>紧接着就是为zepto对象添加的方法。</p>
<h3 id="fragment方法"><a href="#fragment方法" class="headerlink" title="fragment方法"></a>fragment方法</h3></li>
</ol>
<p>​    fragment方法可以根据一个html字符串和一个可选的标签名(作为最外层的容器)生成DOM节点。能够快速生成表格等段落内容。这个方法的返回值是一个DOM节点数组，且可以被其他插件重写，以便在不完全支持DOM的浏览器(IE)中也能正常运作。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">zepto.fragment = <span class="function"><span class="keyword">function</span> (<span class="params">html, name, properties</span>)</span>&#123;</div><div class="line"><span class="keyword">var</span> dom,</div><div class="line">nodes,</div><div class="line">container ;</div><div class="line"><span class="comment">// 使用正则表达式检测是否只有自闭合标签，是则提取标签名直接生成DOM节点</span></div><div class="line"><span class="keyword">if</span> (singleTagRE.test (html)) </div><div class="line">dom = $ (<span class="built_in">document</span>.createElement (<span class="built_in">RegExp</span>.$<span class="number">1</span>)) ;</div><div class="line"> </div><div class="line"><span class="keyword">if</span> (! dom) &#123;</div><div class="line"><span class="comment">//检测html变量是否为字符串，且把其中的自闭合标签规范成XML的闭合方式。</span></div><div class="line"><span class="keyword">if</span> (html.replace) </div><div class="line">html = html.replace (tagExpanderRE, <span class="string">"&lt;$1&gt;&lt;/$2&gt;"</span>) ;</div><div class="line"><span class="comment">//没有标签名时候直接，把html字符串最外部的标签名作为name</span></div><div class="line"><span class="keyword">if</span> (name === <span class="literal">undefined</span>) </div><div class="line">name = (fragmentRE.test (html)) &amp;&amp; (<span class="built_in">RegExp</span>.$<span class="number">1</span>) ;</div><div class="line"><span class="comment">//如果name不是特殊的标签如（tr,*,tbody,table）可以直接设置为默认标签。</span></div><div class="line"><span class="keyword">if</span> (! (name <span class="keyword">in</span> containers)) name = <span class="string">"*"</span> ;</div><div class="line"><span class="comment">//获取标签名对应的dom节点，创建容器</span></div><div class="line">container = containers[name] ;</div><div class="line"><span class="comment">//把使用者的html字符串插入到容器节点中，生成DOM树</span></div><div class="line">container.innerHTML = <span class="string">""</span> + html ;</div><div class="line"><span class="comment">//这里使用了后面定义的each方法，对第一个参数中的每个值分别调用第二个参数。</span></div><div class="line">dom = $.each(</div><div class="line">  <span class="comment">//这里使用call是因为childNodes是nodeList类型变量，没有slice方法。</span></div><div class="line">  slice.call (container.childNodes), </div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="comment">//把创建的子节点删除</span></div><div class="line">  container.removeChild (<span class="keyword">this</span>) ;</div><div class="line">&#125;</div><div class="line">) ;</div><div class="line">&#125;</div><div class="line"><span class="comment">//为dom节点添加属性 </span></div><div class="line"><span class="keyword">if</span> (isPlainObject (properties)) </div><div class="line">&#123;</div><div class="line">  <span class="comment">//把dom转换为zepto对象，方便调用zepto方法。</span></div><div class="line">  nodes = $ (dom) ;</div><div class="line">$.each (properties, <span class="function"><span class="keyword">function</span> (<span class="params">key, value</span>) </span>&#123;</div><div class="line">	<span class="keyword">if</span> ((methodAttributes.indexOf (key)) &gt; (- <span class="number">1</span>)) </div><div class="line">		nodes[key] (value) ;</div><div class="line">  	<span class="keyword">else</span> </div><div class="line">		nodes.attr (key, value) ;</div><div class="line">&#125;) ;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">return</span> dom ;</div><div class="line">&#125;</div><div class="line"> ;</div></pre></td></tr></table></figure>
<h3 id="Z方法"><a href="#Z方法" class="headerlink" title="Z方法"></a>Z方法</h3><p>Z方法的作用是，把一个DOM节点列表（类数组）转换为拥有<code>$.fn</code> 方法的集合 。这个方法可以被插件重写。Z函数是怎样实现这个功能呢？下面看代码。</p>
   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">zepto.Z = <span class="function"><span class="keyword">function</span>(<span class="params">dom, selector</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Z(dom, selector)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p> 在这里可以看到 <code>zepto.Z</code> 方法返回一个Z函数实例，继续深入Z函数中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">zepto.Z.prototype = Z.prototype = $.fn</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Z</span>(<span class="params">dom, selector</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> i, len = dom ? dom.length : <span class="number">0</span></div><div class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++) <span class="keyword">this</span>[i] = dom[i]</div><div class="line">  <span class="keyword">this</span>.length = len</div><div class="line">  <span class="keyword">this</span>.selector = selector || <span class="string">''</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>查看Z函数相关的代码，可以看到Z函数把nodelist中的每个node都复制到对象中，添加selector属性。并把原型设置为<code>$.fn</code> 。继续看下<code>$.fn</code> 为什么这么重要,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<h3 id="isZ方法"><a href="#isZ方法" class="headerlink" title="isZ方法"></a>isZ方法</h3><p><code>$.zepto.isZ</code> 方法用于鉴别对象是不是一个Zepto集合。方法可以被插件重写。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">zepto.isZ = <span class="function"><span class="keyword">function</span>(<span class="params">object</span>) </span>&#123;</div><div class="line">	<span class="keyword">return</span> object <span class="keyword">instanceof</span> zepto.Z</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="init方法"><a href="#init方法" class="headerlink" title="init方法"></a>init方法</h3><p><code>$.zepto.init</code> 方法是zepto库中和JQuery的<code>$.fn.init</code> 相对应的函数。这个函数接收一个CSS选择器字符串和一个可选的上下文对象（用于处理不同种类的情况）。下面来看代码:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">zepto.init = <span class="function"><span class="keyword">function</span> (<span class="params">selector, context</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> dom;</div><div class="line">    <span class="comment">// If nothing given, return an empty Zepto collection</span></div><div class="line">    <span class="keyword">if</span> (!selector) </div><div class="line">        <span class="keyword">return</span> zepto.Z();</div><div class="line">    </div><div class="line"><span class="keyword">else</span> <span class="keyword">if</span> ((<span class="keyword">typeof</span> selector) == <span class="string">"string"</span>) &#123;</div><div class="line">        ...</div><div class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (isFunction(selector)) </div><div class="line">    <span class="keyword">return</span> $(<span class="built_in">document</span>).ready(selector);</div><div class="line"></div><div class="line"><span class="keyword">else</span> <span class="keyword">if</span> (zepto.isZ(selector)) </div><div class="line">    <span class="keyword">return</span> selector;</div><div class="line"></div><div class="line"><span class="keyword">else</span> &#123;</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"><span class="comment">// 对查询到的node集合和选择器生成zepto集合</span></div><div class="line"><span class="keyword">return</span> zepto.Z(dom, selector);</div></pre></td></tr></table></figure>
<p>先看init方法第一层代码。init对selector参数进行判断。</p>
<ol>
<li><p>第一种情况，selector为空</p>
<p>这里返回值为<code>zepto.Z()</code> ，由之前的分析可得到zepto.Z返回一个Z函数实例。在selector为空的情况下会获得一个<code>{length:0,selector:&#39;&#39;}</code> 的对象。</p>
</li>
<li><p>第二种情况，当selector是字符串</p>
<p>当selector是字符串时，先对selector使用trim方法规整化<code>selector = selector.trim ()</code> ，然后又分为三种情况。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (((selector[<span class="number">0</span>]) == <span class="string">"&lt;"</span>) &amp;&amp; (fragmentRE.test(selector))) </div><div class="line">    (dom = zepto.fragment(selector, <span class="built_in">RegExp</span>.$<span class="number">1</span>, context)),</div><div class="line">    (selector = <span class="literal">null</span>);</div></pre></td></tr></table></figure>
<p>   第一种，当selector为html片段时，使用fragment方法生成了dom对象。由于，在Chrome 21 和Firefox 15，如果片段开头不是&lt;符号，生成DOM时候会报错。</p>
<p>   第二种，当context有值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">else</span> <span class="keyword">if</span> (context !== <span class="literal">undefined</span>) <span class="keyword">return</span> $(context).find(selector)</div></pre></td></tr></table></figure>
<p>这里涉及到一个方法find,是<code>$.fn</code> 中的方法，作用是从context的子元素中找到符合selector选择器的元素。find的代码稍后做分析。</p>
<p>​    第三种, selector为普通选择器</p>
<p>判断selector是普通选择器使用了zepto的qsa方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">else</span> dom = zepto.qsa(<span class="built_in">document</span>, selector)</div></pre></td></tr></table></figure>
<p>qsa方法统一了不同浏览器节点操作API。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">zepto.qsa = <span class="function"><span class="keyword">function</span>(<span class="params">element, selector</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> found,</div><div class="line">    <span class="comment">//判断是不是ID</span></div><div class="line">    maybeID = selector[<span class="number">0</span>] == <span class="string">'#'</span>,</div><div class="line">    <span class="comment">//判断是不是css</span></div><div class="line">    maybeClass = !maybeID &amp;&amp; selector[<span class="number">0</span>] == <span class="string">'.'</span>,</div><div class="line">    <span class="comment">//看是不是class和id名,如果是,将'#'或者'.'去除,然后赋值给nameOnlt;</span></div><div class="line">    <span class="comment">//否则,直接将值赋值;</span></div><div class="line">    nameOnly = maybeID || maybeClass ? selector.slice(<span class="number">1</span>) : selector,</div><div class="line">    <span class="comment">//simpleSelectorRE = /^[\w-]*$/,</span></div><div class="line">    <span class="comment">//匹配字母数字下划线和减号的组合;</span></div><div class="line">    isSimple = simpleSelectorRE.test(nameOnly)</div><div class="line">    <span class="comment">//如果有内置getElementById方法,并且是id名;</span></div><div class="line"><span class="keyword">return</span> (element.getElementById &amp;&amp; isSimple &amp;&amp; maybeID) ?</div><div class="line">    <span class="comment">//则返回element.getElementByID(nameOnly)</span></div><div class="line">  ( (found = element.getElementById(nameOnly)) ? [found] : [] ) :</div><div class="line">  <span class="comment">//反之的话,再做一次判断</span></div><div class="line">  <span class="comment">//若element不为元素节点,document,DocumentFragment时;为空,</span></div><div class="line">  (element.nodeType !== <span class="number">1</span> &amp;&amp; element.nodeType !== <span class="number">9</span> &amp;&amp; element.nodeType !== <span class="number">11</span>) ? [] :</div><div class="line">  <span class="comment">//否则,将节点转换成数组;</span></div><div class="line">  slice.call(</div><div class="line">  <span class="comment">//这里是一个三元运算符里套着另一个三元运算符;</span></div><div class="line">    isSimple &amp;&amp; !maybeID &amp;&amp; element.getElementsByClassName ?</div><div class="line">    <span class="comment">//当为class,则调用element.getElementsByClassName(nameOnly) </span></div><div class="line">          maybeClass ? element.getElementsByClassName(nameOnly) :</div><div class="line">            <span class="comment">//否则调用tagName;</span></div><div class="line">          element.getElementsByTagName(selector) :</div><div class="line">   <span class="comment">//这个否则是最外层的判断;</span></div><div class="line">      element.querySelectorAll(selector)</div><div class="line">  )</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
</li>
<li><p>第三种情况，当selector的值为函数</p>
<p>这时候直接在dom加载完成后执行这个函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">else</span> <span class="keyword">if</span> (isFunction(selector)) <span class="keyword">return</span> $(<span class="built_in">document</span>).ready(selector)</div></pre></td></tr></table></figure>
</li>
<li><p>第四种情况，当selector参数已经是一个Z函数实例</p>
<p>因为对Z对象实例的包装对对象没有任何修改。所以这个时候直接返回selector本身。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">else</span> <span class="keyword">if</span> (zepto.isZ(selector)) <span class="keyword">return</span> selector</div></pre></td></tr></table></figure>
</li>
<li><p>最后</p>
<p>最后的分支中，又再分出了5种情况。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (isArray(selector)) </div><div class="line">    dom = compact(selector);</div></pre></td></tr></table></figure>
<p>第一种，当selector是一个数组，使用compact方法处理selector。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//这里调用了一个filter方法,是在$.fn内,以后统一分析;</span></div><div class="line"><span class="comment">//这个函数是去除数组中的null和undefined;</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">compact</span>(<span class="params">array</span>) </span>&#123; <span class="keyword">return</span> filter.call(array, <span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123; <span class="keyword">return</span> item != <span class="literal">null</span> &#125;) &#125;</div></pre></td></tr></table></figure>
<p>第二种,selector为非Z类型对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">else</span> <span class="keyword">if</span> (isObject(selector)) </div><div class="line">    (dom = [selector]),</div><div class="line">    (selector = <span class="literal">null</span>);</div></pre></td></tr></table></figure>
<p>这里直接把对象转化为数组。</p>
<p>第三种，selector为html片段</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">else</span> <span class="keyword">if</span> (fragmentRE.test(selector))</div><div class="line">    dom = zepto.fragment(selector.trim(), <span class="built_in">RegExp</span>.$<span class="number">1</span>, context), selector = <span class="literal">null</span></div></pre></td></tr></table></figure>
<p>第四种，有context的时候</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">else if (context !== undefined) return $(context).find(selector)</div></pre></td></tr></table></figure>
<p>第五种，没有context</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">else dom = zepto.qsa(document, selector)</div></pre></td></tr></table></figure>
<p>注意,这里的判定条件比分支一宽松,期待于对象的toString()方法对操作进行兜底。实现的功能是和分支一是一样的。</p>
</li>
</ol>
<p>最后init函数返回zepto 集合。</p>
<h3 id="函数"><a href="#函数" class="headerlink" title="$函数"></a>$函数</h3><p>\$函数是Zepto对象的根基，当调用这个函数的时候仅仅会调用<code>$.zepto.init</code> </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ = </div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params">selector, context</span>) </span></div><div class="line">&#123;</div><div class="line"><span class="keyword">return</span> zepto.init (selector, context) ;</div><div class="line">&#125;</div><div class="line"> ;</div></pre></td></tr></table></figure>
<h3 id="extend函数"><a href="#extend函数" class="headerlink" title="$.extend函数"></a>$.extend函数</h3><p><code>$.extend</code> 函数类似ES6中的Object.assign方法。用于把一个或多个对象的非undefined属性拷贝到目标对象中。注意，这里的拷贝是深拷贝。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">$.extend = </div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params">target</span>) </span></div><div class="line">&#123;</div><div class="line"><span class="comment">//target 目标对象</span></div><div class="line"><span class="keyword">var</span> deep,</div><div class="line"> <span class="comment">//args需要拷贝的源对象数组。</span></div><div class="line">args = slice.call (<span class="built_in">arguments</span>, <span class="number">1</span>) ;</div><div class="line"><span class="comment">//boolean值</span></div><div class="line"><span class="keyword">if</span> ((<span class="keyword">typeof</span> target) == <span class="string">"boolean"</span>) </div><div class="line">&#123;</div><div class="line">deep = target ;</div><div class="line">target = args.shift () ;</div><div class="line">&#125;</div><div class="line"> </div><div class="line">args.forEach (</div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params">arg</span>) </span></div><div class="line">&#123;<span class="function"><span class="keyword">function</span> (<span class="params">arg</span>) </span></div><div class="line">&#123;</div><div class="line">extend (target, arg, deep) ;</div><div class="line">&#125;&#125;</div><div class="line">) ;</div><div class="line"><span class="keyword">return</span> target ;</div></pre></td></tr></table></figure>
<p>可以看到这里</p>

    

    
</div>


                

                <!-- Post Comments -->
                
                    




                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2018/06/16/Typescript-deep-dive-翻译/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/11/12/JS有趣的BUG/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/myavatar.jpg" alt="kyjo2014's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        467346087@qq.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/" target="_self">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2019/04/">四月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/10/">十月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/09/">九月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/06/">六月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/11/">十一月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">八月 2017<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">七月 2017<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/06/">六月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/05/">五月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">四月 2017<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/10/">十月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/07/">七月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/04/">四月 2016<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2016/03/">三月 2016<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/11/">十一月 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/10/">十月 2015<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/09/">九月 2015<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/archives/2015/08/">八月 2015<span class="sidebar_archives-count">10</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-twitter.png);">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/facebook" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-facebook.png);">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-gplus.png);">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="bestkyjo" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn" style="background-image: url(/img/footer/footer_ico-github.png);">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;LTH's note book
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->
<script src="/js/lazyload.min.js"></script>
<script src="/js/js.min.js"></script>
<script src="/js/nprogress.js"></script>

<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- Swiftye -->


<!-- Local Search-->


<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->


                </main>
            </div>
        </body>
    
</html>
